const t=new class{constructor(t=null){this.board=t||[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.score=0,this.gameOver=!1,this.won=!1,this.isMoved=!1,this.mergeFlags=[[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1]]}getState(){return JSON.parse(JSON.stringify(this.board))}getScore(){return this.score}getStatus(){return this.won?"Won":this.gameOver?"Game Over":"Running"}start(){this.addTile(),this.addTile()}restart(){this.board=[[null,null,null,null],[null,null,null,null],[null,null,null,null],[null,null,null,null]],this.score=0,this.gameOver=!1,this.won=!1,this.isMoved=!1,this.mergeFlags=[[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1],[!1,!1,!1,!1]],this.start()}addTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)null===this.board[e][s]&&t.push([e,s]);if(0===t.length)return;let[e,s]=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}moveLeft(){this.isMoved=!1;for(let t=0;t<4;t++){this.mergeFlags[t]=[!1,!1,!1,!1];for(let e=1;e<4;e++)if(null!==this.board[t][e]){let s=e;for(;s>0&&null===this.board[t][s-1];)this.board[t][s-1]=this.board[t][s],this.board[t][s]=null,s--,this.isMoved=!0;s>0&&this.board[t][s-1]===this.board[t][s]&&!this.mergeFlags[t][s-1]&&(this.board[t][s-1]*=2,this.score+=this.board[t][s-1],this.board[t][s]=null,this.mergeFlags[t][s-1]=!0,this.isMoved=!0)}}this.isMoved&&(this.addTile(),this.checkGameOver(),this.checkWin())}moveRight(){this.board=this.board.map(t=>t.reverse()),this.moveLeft(),this.board=this.board.map(t=>t.reverse())}moveUp(){this.board=this.transposeBoard(),this.moveLeft(),this.board=this.transposeBoard()}moveDown(){this.board=this.transposeBoard(),this.moveRight(),this.board=this.transposeBoard()}transposeBoard(){return this.board[0].map((t,e)=>this.board.map(t=>t[e]))}checkWin(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(2048===this.board[t][e]){this.won=!0;break}}checkGameOver(){for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(null===this.board[t][e]||t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return;this.gameOver=!0}isGameOver(){for(let t of this.state)if(t.includes(0))return!1;for(let t of this.state)for(let e=0;e<t.length-1;e++)if(t[e]===t[e+1])return!1;for(let t=0;t<this.state[0].length;t++)for(let e=0;e<this.state.length-1;e++)if(this.state[e][t]===this.state[e+1][t])return!1;return!0}},e=document.querySelector(".game-board"),s=document.getElementById("restart"),r=document.getElementById("score"),o=document.querySelector(".game-over"),l=document.getElementById("win");function a(){e.innerHTML="",t.getState().forEach(t=>{t.forEach(t=>{let s=document.createElement("div");s.classList.add("field-cell"),t&&(s.classList.add(`field-cell--${t}`),s.textContent=t),e.appendChild(s)})}),r.textContent=t.getScore(),"Won"===t.getStatus()?l.classList.remove("hidden"):"Game Over"===t.getStatus()&&o.classList.remove("hidden")}document.addEventListener("keydown",e=>{if("Game Over"!==t.getStatus()&&"Won"!==t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown()}a()}}),s.addEventListener("click",()=>{window.confirm("Do you want to restart the game? Your current progress will be lost.")&&(t.restart(),a(),l.classList.add("hidden"),o.classList.add("hidden"),s.textContent="Start")}),t.start(),a(),(void 0).className="tile",renderGameBoard(t.getState()),updateScore(t.getScore()),"game_over"===t.getStatus()&&(document.querySelector(".message-lose").classList.remove("hidden"),document.querySelector(".start").textContent="Restart");
//# sourceMappingURL=index.7e4e7b96.js.map
